
<app-header></app-header>
<div class="employees-container">
  
    <div class="header-actions">
      <h1>Zoznam zamestnancov</h1>
      <button *ngIf="isManager" class="btn btn-primary" (click)="openCreateModal()">
        + Prida≈• zamestnanca
      </button>
    </div>
  
    <div class="table-card">
      <table class="styled-table">
        <thead>
          <tr>
            <th>Os. ƒç√≠slo</th>
            <th>Meno</th>
            <th>Priezvisko</th>
            <th>Rola</th>
            <th>Email</th>
            
            <th *ngIf="isManager">Prenesen√© h.</th>
            <th *ngIf="isManager">Akt√≠vny</th>
            
            <th *ngIf="isManager" class="actions-col">Akcie</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="isLoading">
            <td colspan="8" class="text-center">Naƒç√≠tavam...</td>
          </tr>
          <tr *ngFor="let emp of employees" [class.inactive-row]="!emp.is_active">
            <td><span class="badge-number">{{ emp.personal_number }}</span></td>
            <td class="bold">{{ emp.first_name }}</td>
            <td class="bold">{{ emp.last_name }}</td>
            <td>
              <span class="role-badge" [ngClass]="emp.role">{{ emp.role }}</span>
            </td>
            <td>{{ emp.email || '-' }}</td>
            
            <td *ngIf="isManager">{{ emp.initial_hours_balance }}</td>
            <td *ngIf="isManager">
              <span *ngIf="emp.is_active" class="status-active">‚úÖ √Åno</span>
              <span *ngIf="!emp.is_active" class="status-inactive">‚ùå Nie</span>
            </td>
  
            <td *ngIf="isManager" class="actions-col">
              <button class="icon-btn edit" (click)="openEditModal(emp)" title="Upravi≈•">‚úèÔ∏è</button>
              <button class="icon-btn delete" (click)="deleteEmployee(emp.id!)" title="Zmaza≈•">üóëÔ∏è</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  
    <div class="modal-overlay" *ngIf="isModalOpen" (click)="closeModal()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h3>{{ isEditMode ? 'Upravi≈• zamestnanca' : 'Nov√Ω zamestnanec' }}</h3>
          <button class="close-btn" (click)="closeModal()">‚úñ</button>
        </div>
        
        <div class="modal-body form-grid">
          
          <div class="form-group">
              <label>Prihlasovacie meno *</label>
              <input [(ngModel)]="selectedEmployee.username" type="text" [disabled]="isEditMode">
          </div>
  
          <div class="form-group" *ngIf="!isEditMode">
              <label>Heslo *</label>
              <input [(ngModel)]="selectedEmployee.password" type="password">
          </div>
    
          <div class="form-group">
              <label>Osobn√© ƒç√≠slo *</label>
              <input [(ngModel)]="selectedEmployee.personal_number" type="text" maxlength="3">
          </div>
    
          <div class="form-group">
              <label>Meno</label>
              <input [(ngModel)]="selectedEmployee.first_name" type="text">
          </div>
    
          <div class="form-group">
              <label>Priezvisko</label>
              <input [(ngModel)]="selectedEmployee.last_name" type="text">
          </div>
    
          <div class="form-group">
              <label>Email</label>
              <input [(ngModel)]="selectedEmployee.email" type="email">
          </div>
  
          <div class="form-group">
            <label>Rola</label>
            <select [(ngModel)]="selectedEmployee.role">
              <option value="worker">Zamestnanec</option>
              <option value="manager">Mana≈æ√©r</option>
              <option value="admin">Administr√°tor</option>
            </select>
          </div>
  
          <div class="form-group">
            <label>Prenesen√© hodiny</label>
            <input [(ngModel)]="selectedEmployee.initial_hours_balance" type="number" step="0.5">
          </div>
  
          <div class="form-group checkbox-group">
              <label>
                <input type="checkbox" [(ngModel)]="selectedEmployee.is_active">
                Akt√≠vny √∫ƒçet
              </label>
              <small class="hint">Ak vypnete, zamestnanec sa nebude m√¥c≈• prihl√°si≈•.</small>
          </div>
  
        </div>
  
        <div class="modal-footer">
          <button class="btn btn-secondary" (click)="closeModal()">Zru≈°i≈•</button>
          <button class="btn btn-primary" (click)="saveEmployee()">Ulo≈æi≈•</button>
        </div>
      </div>
    </div>
  
  </div>